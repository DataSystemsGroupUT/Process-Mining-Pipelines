version: '3.3'

services:

  anaconda:
    build:
      context: .
      dockerfile: ./Dockerfile
    volumes:
       - ./notebooks:/opt/notebooks
       - ./data:/opt/project/data
    ports:
      - "8888:8888"
      - "8787:8787"
    command:
      /opt/conda/bin/jupyter notebook --notebook-dir=/opt/notebooks --ip='0.0.0.0' --port=8888 --no-browser --allow-root
    tty: true

  neo4j:
    image: arm64v8/neo4j
    restart: unless-stopped
    ports:
      - 7474:7474
      - 7687:7687
    volumes:
      - ./conf:/conf
      - ./data:/data
      - ./import:/import
      - ./logs:/logs
      - ./plugins:/plugins
    environment:
      # Raise memory limits
      - NEO4J_dbms_memory_pagecache_size=1G
      - NEO4J_dbms.memory.heap.initial_size=1G
      - NEO4J_dbms_memory_heap_max__size=1G
      - NEO4J_AUTH=none